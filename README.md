<h1 align="center">
  <img src="./logo.png" alt="vexcel" width="300px">
</h1>
 Позволяет  использовать формулы excel в вашем приложении. 

 Особенности: 
   * Потдержка переменных задаваемых из вне. 
   * Математический порядок действий (Пример: 2+2\*3 получим 8) 
   * Потдерживает функции  (ЕСЛИ, НЕ, ОКРУГЛИТЬ и т.д)
   * Возможность добавлять свои функции
  * Преобразование синтаксического дерева в  json  и обратно.
  * Возмжность преобразовать синтаксическое дерево обратно в формулу. (Необходими если возможно изменение названий переменных со временем) 
 

1) Установка
2) Начало работы. 
4) Функции список
5) Использование переменных
6) Для разработчиков (добавление функций)

### Примеры 
Результато вычислений кода ниже будет 15: 
```code
3*(2+2+(1*1)) 
```
Так же если ввести переменную "ВАШАПЕРЕМЕННАЯ" и попробовать посчитать, то результат будет ВАШАПЕРЕМЕННАЯ * 5 (Если эта переменная будет равнятся 3 то результат вернется 15): 
```code
ВАШАПЕРЕМЕННАЯ*(2+2+(1*1)) 
```

Пример формулы с функциями: 
```code
ЕСЛИ(НЕ(3<2);"ДА";"НЕТ")
```
В результате вернется строка со значением 'ДА'. 

## Установка 

## Начало работы    

Подключение: 
```php
<?php
...
use Wladimir\ParserExcel\Parser\Parser;
```
 ### Использование без переменных: 
```php
$parser = new Parser();
$ast = $parser->parse('3+3');// Получили синтаксическое дерево
$answer = $ast->calculate(); // $answer = 6
````

### Использование переменных в формулах: 
Для использования переменных, нам необходимо объяснить системе как брать значения переменных. Для этого создате класс реализующий интерфейс ValueRepository: 
Например, давайте представим что у нас есть переменные названия которых соответсвуют числам ("ОДИН"=1, "ДВА"=2, "ТРИ"=3 и тд). Тогда класс будет иметь следующий вид: 
```php
use Wladimir\ParserExcel\Repository\ValueRepositoryInterface;

class ValueRepositoryFake implements ValueRepositoryInterface
{
    /** @var array<string, int> */
    private array $variables = [
        'ОДИН'   => 1,
        'ДВА'    => 2,
        'ТРИ'    => 3,
        'ЧЕТЫРЕ' => 4,
        'ПЯТЬ'   => 5,
        'ШЕСТЬ'  => 6,
    ];

    public function getValueByIdentifier(string $identificator): mixed
    {
        return $this->variables[$identificator];
    }
}
```
Далее мы передаем экземпляр этого класса для подсчета: 
```php
$parser = new Parser();
$ast = $parser->parse('ТРИ+3');// Получили синтаксическое дерево

$repository = new ValueRepositoryFake();// Наш репозиторий

$answer = $ast->calculate($repository); // $answer = 6
```
### Использование функций:
