<h1 align="center">
  <img src="./logo.png" alt="vexcel" width="300px">
</h1>
 Позволяет  использовать формулы excel в вашем приложении. 
 
## Описание:  
Формулы в эксель - это прекрасное изобретение которое позволяет пользователям производить расчеты без помощи программистов. Нередко возникают ситуации когда такой функционал нужен в вашем приложении! Эта библиотека позволит вам использовать выражения синтаксически похожие на формулы из excel, с той лишь разницей, что в место координат ячеек вы сможете использовать свои переменные. 

 ## Особенности: 
   * Потдержка переменных задаваемых из вне. 
   * Математический порядок действий (Пример: 2+2\*3 получим 8) 
   * Потдерживает функции  (ЕСЛИ, НЕ, ОКРУГЛИТЬ и т.д)
   * Возможность добавлять свои функции
  * Преобразование синтаксического дерева в  json  и обратно.
  * Возмжность преобразовать синтаксическое дерево обратно в формулу. (Необходими если возможно изменение названий переменных со временем) 

## Установка 

## Начало работы    

Подключение: 
```php
<?php
...
use Wladimir\ParserExcel\Parser\Parser;
```
 ### Использование без переменных: 
```php
$parser = new Parser();
$ast = $parser->parse('3+3');// Получили синтаксическое дерево
$answer = $ast->calculate(); // $answer = 6
````

### Использование переменных в формулах: 
Для использования переменных, нам необходимо объяснить системе как брать значения переменных. Для этого создате класс реализующий интерфейс ValueRepository: 
Например, давайте представим что у нас есть переменные названия которых соответсвуют числам ("ОДИН"=1, "ДВА"=2, "ТРИ"=3 и тд). Тогда класс будет иметь следующий вид: 
```php
use Wladimir\ParserExcel\Repository\ValueRepositoryInterface;

class ValueRepositoryFake implements ValueRepositoryInterface
{
    /** @var array<string, int> */
    private array $variables = [
        'ОДИН'   => 1,
        'ДВА'    => 2,
        'ТРИ'    => 3,
        'ЧЕТЫРЕ' => 4,
        'ПЯТЬ'   => 5,
        'ШЕСТЬ'  => 6,
    ];

    public function getValueByIdentifier(string $identificator): mixed
    {
        return $this->variables[$identificator];
    }
}
```
Далее мы передаем экземпляр этого класса для подсчета: 
```php
$parser = new Parser();
$ast = $parser->parse('ТРИ+3');// Получили синтаксическое дерево

$repository = new ValueRepositoryFake();// Наш репозиторий

$answer = $ast->calculate($repository); // $answer = 6
```
### Использование функций:
